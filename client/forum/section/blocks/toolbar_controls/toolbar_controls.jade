- var subscriptionTypes = '$$ JSON.stringify(N.models.users.Subscription.types) $$'

- var items = []

if self.runtime.is_member
  - items.push('mark_read')
  - items.push('subscription')

if items.length > 0
  - items.push('divider')

//- TODO: implement
- items.push('mod_header')
- items.push('mod_announce')
- items.push('mod_add_moderator')
  
if self.selected_cnt !== 0
  if items.length > 0
    - items.push('divider')
  - items.push('many_header')
  - items.push('many_unselect')
  if self.settings.forum_mod_can_delete_topics
    - items.push('many_delete')
    - items.push('many_undelete')
  if self.settings.forum_mod_can_pin_topic
    - items.push('many_pin')
    - items.push('many_unpin')
  - items.push('many_move')
  - items.push('many_prune')

//- If last item is header - remove it
if items.length > 0 && items[items.length - 1] === 'header'
  - items.pop()


.page-actions.forum-section__toolbar-controls
  if self.settings.forum_can_start_topics
    button.btn.btn-primary.icon.icon-plus(
      data-on-click='forum.section:create'
      data-section-hid=self.section.hid
      data-section-title=self.section.title
      type='button'
      title=self.t('topic_create')
    )

  if self.runtime.is_member
    button.btn.btn-default.hidden-xxs.icon.icon-check(
      type='button'
      data-on-click='forum.section:mark_read'
      data-section-hid=self.section.hid
      title=self.t('mark_read')
    )

  - var subscriptionIcon = 'icon-track-normal'
  - var subscriptionTitle = self.t('subs_normal')

  if (self.subscription === subscriptionTypes.MUTED)
    - subscriptionIcon = 'icon-track-muted'
    - subscriptionTitle = self.t('subs_muted')
  else if (self.subscription === subscriptionTypes.TRACKING)
    - subscriptionIcon = 'icon-track-tracking'
    - subscriptionTitle = self.t('subs_tracking')
  else if (self.subscription === subscriptionTypes.WATCHING)
    - subscriptionIcon = 'icon-track-watching'
    - subscriptionTitle = self.t('subs_watching')

  if (self.subscription && self.subscription !== subscriptionTypes.NORMAL)
    button.btn.btn-default.hidden-xxs.icon(
      title=subscriptionTitle
      class=subscriptionIcon
      data-on-click='forum.section:subscription'
      data-section-hid=self.section.hid
      data-section-subscription=self.subscription
    )

  if items.length > 0
    .page-actions__dropdown

      button.btn.btn-default.dropdown-toggle(type='button', data-toggle='dropdown')
        span.caret

      ul.dropdown-menu.dropdown-menu-right

        each item in items
          case item

            when 'mark_read'
              li.visible-xxs-block: a(href='#'
                data-on-click='forum.section:mark_read'
                data-section-hid=self.section.hid
              )= self.t('mark_read')

            when 'subscription'
              li: a(href='#'
                data-on-click='forum.section:subscription'
                data-section-hid=self.section.hid
                data-section-subscription=self.subscription
              )
                if self.subscription && self.subscription !== subscriptionTypes.NORMAL
                  span.icon(class=subscriptionIcon)
                  | 
                = self.t('subscription')

            when 'divider'
              li.divider

            when 'mod_header'
              li.dropdown-header= self.t('mod_actions')

            when 'mod_announce'
              li.disabled: a(href='#')= self.t('announce')

            when 'mod_add_moderator'
              li.disabled: a(href='#')= self.t('add_moderator')

            when 'many_header'
              li.dropdown-header=self.t('many_header', { count: self.selected_cnt })

            when 'many_unselect'
              li: a(href='#'
                data-on-click='forum.section:topics_unselect'
              )=self.t('many_unselect')

            when 'many_delete'
              li: a(href='#'
                data-on-click='forum.section:delete_many'
              )= self.t('many_delete')

            when 'many_undelete'
              li: a(href='#'
                data-on-click='forum.section:undelete_many'
              )= self.t('many_undelete')

            when 'many_pin'
              li: a(href='#'
                data-on-click='forum.section:pin_many'
              )= self.t('many_pin')

            when 'many_unpin'
              li: a(href='#'
                data-on-click='forum.section:unpin_many'
              )= self.t('many_unpin')
            when 'many_move'
              li.disabled: a(href='#')= self.t('many_move')

            when 'many_prune'
              li.disabled: a(href='#')= self.t('many_prune')
