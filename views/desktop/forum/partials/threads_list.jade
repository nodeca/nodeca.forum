//- This template is used for:
//- - the whole page generation
//- - appending next page posts via autoload or "more" button
ul.tl-thread-list
  - var replies, views;
  - if (self.show_page_number)
    li.tl-head= self.t('forum.page_separator', { page: self.show_page_number })

  - each thread in self.threads
    - fp_user = thread.cache.real.first_user
    - lp_user = thread.cache.real.last_user
    - fp_ts   = thread.cache.real.first_ts
    - lp_ts   = thread.cache.real.last_ts
    li
      .row
        .span7.tl-item-summary
          h2
            a(href=self.link_to('forum.thread', thread))= thread.title
          //a.mark-i-attach._tip(href="#")=thread.attach_count
          - if (thread.cache._page_number > 1)
            //- micro-pagination
            ul.tl-pages
              li
                a(href=self.link_to('forum.thread', thread)) 1
              - thread.page = 2;
              li
                a(href=self.link_to('forum.thread', thread)) 2
              //- elipsis displayed, if pages count > 2 first + 2 last 
              - if (thread.cache._page_number > 4)
                li
                  ...
              - if (thread.cache._page_number > 3)
                - thread.page = thread.cache._page_number - 1;
                li
                  a(href=self.link_to('forum.thread', thread)) #{thread.page}
              - if (thread.cache._page_number > 2)
                - thread.page = thread.cache._page_number;
                li
                  a(href=self.link_to('forum.thread', thread)) #{thread.page}
          .tl-meta
            a.tl-preview-ctl.icon-down(href='#')= self.t('forum.action.thread_preview')
            - if (self.users[fp_user])
              a.tl-starter(href=self.link_to('users.member', self.users[fp_user])) #{self.users[fp_user]._uname}
            time.tl-start-date(datetime=self.date(fp_ts, 'iso')) #{self.date(fp_ts, 'date')}

        ul.span2.tl-item-counters.hidden-phone
          - replies = thread.cache.real.post_count - 1;
          - views = thread._views_count;
          li
            | #{replies}
            = self.t('forum.counter.thread_replies', { count: replies })
          li
            | #{views}
            = self.t('forum.counter.thread_views', { count: views })

        ul.span3.tl-item-lastpost.hidden-phone
          li.lastpost-time
            a(href='#')
              time(datetime=self.date(lp_ts, 'iso')) #{self.date(lp_ts, 'date')}
          - if (self.users[lp_user])
            li.lastpost-user
              a(href=self.link_to('users.member', self.users[lp_user])) #{self.users[lp_user]._uname}
